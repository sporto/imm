IMM.js
========

[ ![Codeship Status for sporto/imm](https://www.codeship.io/projects/c6ea6970-2eac-0132-d151-0605b547a2e8/status)](https://www.codeship.io/projects/39398)

__Immutable__ data collections built on top of [seamless-immutable](https://github.com/rtfeldman/seamless-immutable)

Seemless-immutable.js is great, but it doesn't have an API that feels right for CRUD applications. 
Imm wraps it to provide a convenient API. For example:

```js
collection.add(record);
collection.get(id);
collection.update(record);
...
```

Install
-------

### Using NPM

```bash
npm install imm
```

### Browser global

Download `dist/imm.js` or `dist/imm.min.js`

This library requires [seamless-immutable](https://github.com/rtfeldman/seamless-immutable) to be loaded.

## API

### [list](dist/imm.js#L131)

Returns an Imm list Keys are always sorted in alphabetical order

imm assumes that the id key is called `id`. You can provide an optional argument:

**Params**

* **{Array}**: records Array of records    
* **{Object}**: args Optional arguments    
* **{String}**: args.key=id Optional name of id key e.g. _id    
* `returns` **{Imm.list}**: Imm list  

**Examples**

```js
var records = [{id: 1, label: 'Sam'}, {...}];
collection = imm.list(records);
```

```js
collection = imm.list(records, {key: '_id'});
```

### [add](dist/imm.js#L205)

Adds one or more records. If record already exists then it gets replaced. If a record doesn't have a key, then the key will be autogenerated.

**Params**

* **{Object|Array}**: recordOrRecords Record or records to add    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throw if record already exists    
* `returns` **{Imm}**: modified collection  

**Example**

```js
// add one
collection = collection.add(record)

// add many records
collection = collection.add(array)
```

### [allExist](dist/imm.js#L235)

Check if the given ID or all given IDs exist.

**Params**

* **{Number|String|Array}**: idOrIds ID or IDs to check    
* `returns` **{Boolean}**  

**Example**

```js
var exist = allExist(21);
var exist = allExist([11, 21]);
```

### [anyExist](dist/imm.js#L260)

Check if the given ID or any given IDs exist

**Params**

* **{Number|String|Array}**: idOrIds Id or Ids to check    
* `returns` **{Boolean}**  

**Example**

```js
var exist = anyExist(21);
var exist = anyExist([11, 21]);
```

### [array](dist/imm.js#L284)

Get all records. Records in the array are plain mutable JS objects.

* `returns` **{Array}**: records Plain array with records  

**Example**

```js
var records = collection.array();
```

### [count](dist/imm.js#L306)

Records count.

* `returns` **{Number}**: count  

**Example**

```js
count = collection.count();
```

### [filter](dist/imm.js#L325)

Filters the collection based on a filtering function.

**Params**

* **{Function}**: filterer Filtering function    
* `returns` **{Imm}**: Modified collection  

**Example**

```js
collection = collection.filter(function (record) {
  return record.age > 18;
});
```

### [find](dist/imm.js#L347)

Finds one record. Returns a plain JS mutable object.

**Params**

* **{Function}**: finder Finder function    
* `returns` **{Object}**: record Record or undefined  

**Example**

```js
var record = collection.find(function (record) {
  return record.age === 18;
});
```

### [get](dist/imm.js#L373)

Get a record. Returned record is a plain JS mutable object.

**Params**

* **{Number|String}**: id Id to fetch    
* `returns` **{Object}**: record  

**Example**

```js
var record = collection.get(11)
var record = collection.get('11') // same as 11
```

### [map](dist/imm.js#L395)

Map the collection through a given function

**Params**

* **{Function}**: mapper Mapping function    
* `returns` **{Array}**: array  

**Example**

```js
collection = collection.map(function (record) {
  return {foo: record.id};
});
```

### [remove](dist/imm.js#L417)

Removes one or many records based on the id. If record is not found then it just gets skipped.

**Params**

* **{Number|String|Array}**: idOrIds Id or ids to remove    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throw if record(s) doesn't exists    
* `returns` **{Imm}**: Modified collection  

**Example**

```js
collection = collection.remove(id);
collection = collection.remove(arrayOfIds);
```

### [replace](dist/imm.js#L451)

Replaces one item or many. This discards any previous data from the replaced items. If records doesn't exist then it just gets added. This throws if a record doesn't have an key.

**Params**

* **{Object}**: recordOrRecords Record or records to replace    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throws if record exist    
* **{Boolean}**: args.requireKey=true Throws if record doesn't have a key    
* `returns` **{Imm}**: Modified Imm collection  

**Example**

```js
collection = collection.replace(record)
collection = collection.replace(array)
```

### [update](dist/imm.js#L510)

Updates one record or many. This merges the given data with the existing one. If a record is not found then it gets added. This throws if a record doesn't have an key

**Params**

* **{Object|Array}**: recordOrRecords Record or records to update    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throws if record exist    
* `returns` **{Imm}**: Modified collection  

**Example**

```js
collection = collection.update(record)
collection = collection.update(array)
```

### [obj](dist/imm.js#L603)

Returns an Seamless Immutable object

**Params**

* **{Object}**: data A JS object    
* `returns` **{Immutable}**: Immutable object  

**Example**

```js
var data = {id: 1, label: 'Sam'};
var record = imm.obj(data);
```

### Things to note

- Methods that return collections (e.g. filter) return an instance of Imm
- Methods that return one record (e.g. get, find), return a plain JS object

Test
----

```bash
npm install
npm test
```

Build
-----

This will lint, test, minify and create documentation

```bash
gulp
```

Related projects
----------------

- [immutable.js](https://github.com/facebook/immutable-js)
- [seamless-immutable](https://github.com/rtfeldman/seamless-immutable)