IMM.js
========

[ ![Codeship Status for sporto/imm](https://www.codeship.io/projects/c6ea6970-2eac-0132-d151-0605b547a2e8/status)](https://www.codeship.io/projects/39398)

__Immutable__ data collections build on top of [seamless-immutable](https://github.com/rtfeldman/seamless-immutable)

Seemless-immutable.js is great, but it doesn't have an API that feels right for CRUD applications. 
Imm wraps it to provide a convenient API. For example:

```js
collection.add(record);
collection.get(id);
collection.update(record);
...
```

Install
-------

### Using NPM

```bash
npm install imm
```

### Browser global

Download `dist/imm.js` or `dist/imm.min.js`

This library requires [seamless-immutable](https://github.com/rtfeldman/seamless-immutable) to be loaded.

## API
### [imm](src/imm.js#L136)

Returns an Imm collection Keys are always sorted in alphabetical order

* **{Array}**: records Array of records    
* **{Object}**: args Optional arguments    
* **{String}**: args.key=id Optional name of id key e.g. _id    
* `returns` **{Imm}**: Imm collection  

**Example usage**

```js
var records = [{id: 1, label: 'Sam'}, {...}];
collection = imm(records);
```

imm assumes that the id key is called `id`. You can provide an optional argument:

```js
collection = imm(records, '_id');
```

### [add](src/imm.js#L203)

Adds one or more records. If record already exists then it gets replaced. If a record doesn't have a key, then the key will be autogenerated.

* **{Object|Array}**: recordOrRecords Record or records to add    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throw if record already exists    
* `returns` **{Imm}**: modified collection  

**Example**

```js
// add one
collection = collection.add(record)

// add many records
collection = collection.add(array)
```

### [allExist](src/imm.js#L227)

* **{Number|String|Array}**: idOrIds Id or Ids to check    
* `returns`: {Boolean}  

Check if the given id or all given ids exist
Return true if all record exist

### [anyExist](src/imm.js#L244)

* **{Number|String|Array}**: idOrIds Id or Ids to check    
* `returns`: {Boolean}  

Check if the given id or any given ids exist
Return true if any ids exist

### [array](src/imm.js#L266)

Get all records as a plain JavaScript array Records in the array are plain mutable JS objects

* `returns` **{Array}**: records  

**Example usage**

```js
var records = collection.array();
```

### [count](src/imm.js#L288)

Returns the records count

* `returns` **{Number}**: count  

**Example usage**

```js
count = collection.count();
```

### [filter](src/imm.js#L307)

Filters the collection based on a filtering function.

* **{Function}**: filterer Filterer function    
* `returns` **{Imm}**: Modified collection  

**Example usage**

```js
collection = collection.filter(function (record) {
  return record.age > 18;
});
```

### [find](src/imm.js#L329)

Finds one record Returns a plain JS mutable object

* **{Function}**: finder Finder function    
* `returns` **{Object}**: Record or undefined  

**Example usage**

```js
var record = collection.find(function (record) {
  return record.age === 18;
});
```

### [get](src/imm.js#L355)

Get a record Returned record is a plain JS mutable object

* **{Number|String}**: id Id to get    
* `returns` **{Object}**: record  

**Example usage**

```js
var record = collection.get(11)
```

Key is expected to be exactly as in the record, e.g. number or string

### [map](src/imm.js#L376)

Map the collection through a given function

* **{Function}**: mapper Mapping function    
* `returns` **{Misc}**: Anything depending on the mapper  

**Example usage**

```js
collection = collection.map(function (record) {
  return {foo: record.id};
});
```

### [remove](src/imm.js#L398)

Removes one or many records based on the id. If record is not found then it just gets skipped.

* **{Number|String|Array}**: idOrIds Id or ids to remove    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict Throw if record(s) doesn't exists    
* `returns` **{Imm}**: modified collection  

**Example usage**

```js
collection = collection.remove(id);
collection = collection.remove(arrayOfIds);
```

### [replace](src/imm.js#L432)

Replaces one item or many. This discards any previous data from the replaced items. If records doesn't exist then it just gets added This throws if a record doesn't have an key

* **{Object}**: recordOrRecords Record or records to replace    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throws if record exist    
* **{Boolean}**: args.requireKey=true Throws if record doesn't have a key    
* `returns` **{Imm}**: modified collection  

**Example usage**

```js
collection = collection.replace(record)
collection = collection.replace(array)
```

### [update](src/imm.js#L511)

Updates one record or many. This merges the given data with the existing one. If a record is not found then it gets added. This throws if a record doesn't have an key

* **{Object|Array}**: recordOrRecords Record or records to update    
* **{Object}**: args Optional arguments    
* **{Boolean}**: args.strict=false Throws if record exist    
* `returns` **{Imm}**: modified collection  

**Example usage**

```js
collection = collection.update(record)
collection = collection.update(array)
```


### Things to note

- Methods that return collections (e.g. filter) return an instance of Imm
- Methods that return one record (e.g. get, find), return a plain JS object

Test
----

```bash
npm install
npm test
```

Build
-----

This will lint, test, minify and create documentation

```bash
gulp
```

Related projects
----------------

- [immutable.js](https://github.com/facebook/immutable-js)
- [seamless-immutable](https://github.com/rtfeldman/seamless-immutable)