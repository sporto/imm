!function(r,n){if("function"==typeof define&&define.amd)define(["Immutable"],function(t){return r.imm=n(t)});else if("object"==typeof exports){var t=require("immutable");module.exports=n(t)}else r.imm=n(r.Immutable)}(this,function(r){function n(n,o){if(!e(n))throw new Error("You must provide an array");var u=r.Sequence(n).valueSeq();return t(o,u)}function t(n,e){function o(r){return t(n,r)}function u(n,t){{var e=r.Map(n);r.Map(t)}return e.mergeDeep(t).toJS()}function i(r){return f(r[n])}function f(r){return e.findIndex(function(t){return t[n]==r})}function c(r){return e.find(function(t){return t[n]==r})}function a(r){var n,t=i(r);return n=t>-1?e.splice(t,1,r):e.concat([r]),o(n)}function d(r){var n=i(r);if(-1==n)return a(r);throw new Error("Record already exists")}function m(r){var n=i(r);if(-1==n)throw new Error("Record does not exists");return a(r)}function s(r){if(!r[n])throw new Error("Record must have an id");var t=i(r);if(-1==t)throw new Error("Record not found");var f=e.get(t),c=u(f,r),a=e.splice(t,1,c);return o(a)}function v(r){var n=f(r);if(-1==n)throw new Error("Record not found");var t=e.splice(n,1);return o(t)}function l(r){var n=e.map(r);return o(n)}function p(r){var n=e.filter(r);return o(n)}function w(r){var n=e.sort(r);return o(n)}function b(){return e}return n=n||"id",{isImm:!0,count:e.count.bind(e),get:c,set:a,add:d,replace:m,update:s,remove:v,find:e.find.bind(e),map:l,filter:p,sort:w,toJS:e.toJS.bind(e),toImmutable:b}}var e=Array.isArray||function(r){return"[object Array]"===toString.call(r)};return n});